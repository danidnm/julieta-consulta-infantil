<form x-data="reviewForm()" x-init="init()" @submit.prevent="save()" class="space-y-6">

    <template x-if="loading">
        <div class="flex items-center justify-center py-4 text-gray-500">
            <span class="loading loading-spinner loading-sm"></span>
            <span class="ml-2 text-sm">Cargando revisión...</span>
        </div>
    </template>

    <template x-if="!loading">

        <div class="space-y-6">

            <input
                    class="input input-bordered w-full"
                    type="hidden"
                    x-model="review.patient_id"
                    required
            >

            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700">Nombre del Paciente</label>
                <input
                        class="input input-bordered w-full"
                        type="text"
                        x-model="patient.name"
                        disabled
                >
            </div>

            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700">Temperatura corporal (°C)</label>
                <input
                        class="input input-bordered w-full"
                        type="number"
                        step="0.1"
                        min="34"
                        max="43"
                        x-model="review.temperature"
                        placeholder="Ej: 36.5"
                        required
                >
            </div>

            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700">Síntomas</label>
                <textarea
                        class="textarea textarea-bordered w-full"
                        x-model="review.symptoms"
                        placeholder="Ej: tos, dolor de cabeza"
                        rows="4"
                        required
                ></textarea>
            </div>

            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700">Pruebas realizadas</label>
                <div class="space-y-2">
                    <div class="flex items-center gap-2">
                        <input
                                type="checkbox"
                                id="test1"
                                class="checkbox checkbox-primary"
                                x-model="review.tests"
                                value="Análisis de sangre"
                        >
                        <label for="test1" class="text-sm text-gray-700">Análisis de sangre</label>
                    </div>
                    <div class="flex items-center gap-2">
                        <input
                                type="checkbox"
                                id="test2"
                                class="checkbox checkbox-primary"
                                x-model="review.tests"
                                value="Radiografía"
                        >
                        <label for="test2" class="text-sm text-gray-700">Radiografía</label>
                    </div>
                    <div class="flex items-center gap-2">
                        <input
                                type="checkbox"
                                id="test3"
                                class="checkbox checkbox-primary"
                                x-model="review.tests"
                                value="Ecografía"
                        >
                        <label for="test3" class="text-sm text-gray-700">Ecografía</label>
                    </div>
                    <div class="flex items-center gap-2">
                        <input
                                type="checkbox"
                                id="test4"
                                class="checkbox checkbox-primary"
                                x-model="review.tests"
                                value="Otras pruebas"
                        >
                        <input
                                type="text"
                                class="input input-bordered input-sm flex-1"
                                placeholder="Especificar otras pruebas"
                                x-model="review.otherTests"
                                :disabled="!review.tests?.includes('Otras pruebas')"
                        >
                    </div>
                </div>
            </div>

            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700">Resultado de las pruebas</label>
                <textarea
                        class="textarea textarea-bordered w-full"
                        x-model="review.result"
                        rows="4"
                        placeholder="Describe los resultados de las pruebas"
                        required
                ></textarea>
            </div>

            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700">Fecha revisión</label>
                <input
                        class="input input-bordered w-full"
                        type="date"
                        x-model="review.date"
                        required
                >
            </div>

            <div class="flex gap-4 pt-4">
                <button class="btn btn-success flex-1" type="submit">
                    Guardar revisión
                </button>
                <button
                        class="btn btn-secondary flex-1"
                        type="button"
                        @click="location.hash = '#PatientEdit/' + review.patient_id"
                >
                    Cancelar
                </button>
            </div>
        </div>

    </template>
</form>
